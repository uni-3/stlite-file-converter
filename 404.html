<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Stlite File Converter</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@stlite/browser@0.85.1/build/stlite.css"
    />
  </head>
  <body>
    <div id="root"></div>
    <script type="module">
      import { mount } from "https://cdn.jsdelivr.net/npm/@stlite/browser@0.85.1/build/stlite.js";

      // Calculate the base path for GitHub Pages or local development.
      // This allows the app to load correctly even when accessed via a sub-path (e.g., /markitdown).
      const isGitHubPages = window.location.hostname.includes('github.io');
      const pathSegments = window.location.pathname.split('/');
      const repoName = isGitHubPages ? pathSegments[1] : '';
      const basePath = repoName ? `/${repoName}/` : '/';

      mount(
        {
          requirements: ["markitdown-no-magika", "pdfminer.six", "pypdf", "tabulate"],
          entrypoint: "streamlit_app.py",
          files: {
            "streamlit_app.py": {
              url: basePath + "streamlit_app.py",
            },
            "pages/markitdown.py": {
              url: basePath + "pages/markitdown.py",
            },
            "requirements.txt": {
              url: basePath + "requirements.txt",
            },
          },
          streamlitConfig: {
            "server.baseUrlPath": basePath,
          },
        },
        document.getElementById("root")
      );
    </script>
  </body>
</html>
